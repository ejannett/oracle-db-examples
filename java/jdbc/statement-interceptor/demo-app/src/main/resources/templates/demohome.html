<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet"
          th:href="@{/webjars/bootstrap/5.3.3/css/bootstrap.min.css}"/>


</head>
<body onload="setupCleanerandListener()">
<div id="homeland" class="container-fluid d-flex flex-column">
    <div class="d-flex">
        <div id="banner" class="p-2 border border-bottom flex-fill">
            <h1 class="text-center">Welcome to JDBC Statement interceptor
                demonstration.</h1>
            <p class="text-center">
                This simple application demonstrates the use of <a
                    href="https://docs.oracle.com/en/database/oracle/oracle-database/23/jajdb/oracle/jdbc/spi/TraceEventListenerProvider.html">
                Oracle JDBC trace event listener</a>
                to analyse outgoing SQL statements.
            </p>
            <p class="text-center">
                This application datasource are configured to leverage Statement
                listener of the <a
                    href="https://orahub.oci.oraclecorp.com/ora-jdbc-dev/jdbc-interceptor">JDBCInterceptor
                project</a>
            </p>
        </div>
    </div>
    <div class="p-2">
        <div class="align-self-center">
            <button class="btn btn-primary" type="button"
                    data-bs-toggle="collapse" data-bs-target="#offcanvasParams"
                    aria-expanded="false" aria-controls="collapseExample">
                Interceptor rules...
            </button>
        </div>
        <div class="collapse" id="offcanvasParams">
            <div class="card card-body"
                 th:insert="~{fragments/demo_params :: demo_params}">

            </div>
        </div>
    </div>
    <div id="homeland_center" class="d-flex flex-row">

        <div id="wks" class="p-2 flex-grow-1"
             th:insert="~{fragments/workshop :: workshop_main}"></div>
        <div id="stats" class="p-2 flex-shrink-1 align-self-start"
             hx-trigger="operation-ended from:body" hx-get="/interceptor/stats">
            <div th:insert="~{fragments/demo_stats :: demo_stats}"></div>
        </div>
    </div>
    <div id="notifs"
         th:insert="~{fragments/notificationArea :: notif_area}"></div>
</div>


<script th:src="@{/webjars/bootstrap/5.3.3/js/bootstrap.min.js}"></script>
<script th:src="@{/webjars/htmx.org/2.0.0/dist/htmx.js}"></script>
<script>
    function setupCleanerandListener() {
        document.getElementById("searchsubmit").setAttribute("onclick", "startSubmition()");
        document.body.addEventListener('htmx:afterSwap', event=>{
            if (event.target.id === 'emplist') {
                // That means we just finish a search request to the server
                document.getElementById("requestSpinner").classList.toggle("d-none");

            }
        })
    }
    function startSubmition() {
        clearErrorArea();
        document.getElementById("requestSpinner").classList.toggle("d-none");
    }

    function clearErrorArea() {
        document.getElementById('exceptioncontainer').innerHTML = "";
    }

</script>
</body>
</html>
